<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Start your subscription!</title>

        <link rel="stylesheet" href="css/account.css"/> 
</head>
<body>

<%- include("partials/PS_header.ejs") %>

<div class="account-container">
        <div id="account-overview">
            <h2>Welcome to Your Account</h2>
            <p>Manage your subscription and Personal details here.</p>
        </div>

    <div class="account-top-row">


        <div id="personal-details">
            <h3>Your Details</h3>
            <p>Name: <%= signupData.firstname %> <%= signupData.lastname %></p>
            <p>Email: <%= signupData.email %></p>
            <p>Username: <%= signupData.username %></p>

        </div>

        <div id="current-subscription-details">
            <h3>Your Current Subscription</h3>
            <p>Subscription Type: <%= signupData2.sub_type %></p>
                <p>Frequency: <%= signupData2.freq_type %></p>

            <p>Next Amourly:</p>
            <p id="preview-poem">How do I love thee? Let me count the ways.
                I love thee to the depth and breadth and height
                My soul can reach, when feeling out of sight
                For the ends of being and ideal grace.
                I love thee to the level of every day's
                Most quiet need, by sun and candle-light.
                I love thee freely, as men strive for right.
                I love thee purely, as they turn from praise.
                I love thee with the passion put to use
                In my old griefs, and with my childhood's faith.
                I love thee with a love I seemed to lose
                With my lost saints. I love thee with the breath,
                Smiles, tears, of all my life; and, if God choose,
                I shall but love thee better after death.
                <strong>- Elizabeth Barrett Browning</strong> </p>
            <p>Next Billing Date:</p>


        </div>    
        
        <div id="delivery-details">
            <h3>Recipient Details</h3>

            <p>Delivery Email: </p><span id="editable-text-email"><%= signupData.recipient_email %></span>
            <input type="text" id="edit-input-email" style="display:none;" name="recipient-email"/>
            <button class="edit-button-email"onclick="toggleEditEmail()">Edit Email</button>
            <button class="edit-btnemail" onclick="saveEditEmail()" style="display:none;" id="save-btnemail">Save New Email</button>
<br/><br/>

            <p>Address:</p><span id="editable-text-address"><%= signupData2.recipientAddress || `N/A` %></span>
            <input type="text" id="edit-input" style="display:none;" name="recipientpost"/>
            <button class="edit-button"onclick="toggleEdit()">Edit Address</button>
            <button class="edit-button" onclick="saveEdit()" style="display:none;" id="save-btn">Save New Address</button>
<br/><br/>
            <div id="date-container">
            <p>Next Subscription Delivery date: </p>
            <span id="date-display"><%= savedDate || 'No date selected' %></span>
            <input type="date" id="date-picker" style="display:none;" name="next-delivery" />
            <button class="edit-button" id="edit-date-btn">Edit Next Delivery Date</button>
            <button class="edit-button" id="save-date-btn" style="display:none;">Save New Date</button>
            </div>
        </div>


        </div>

        <div class="account-second-row">

        <div id="account-edit-options">
            <h3>Edit Your Account:</h3>
            <button class="edit-details-button">Change Personal Details</button>
            <button class="change-password-button">Change Password</button>
            <button class="manage-subscription-button">Upgrade Subscription</button>
        </div>



        <div id="subscription-history">
            <h3>Subscription History</h3>
            <ul id="history-list">
                <li>June 15, 2025 - Passionate Outpour - Billed </li>
                <li>May 15, 2025 - Passionate Outpour - Billed $29.99</li>
                <li>April 15, 2025 - Passionate Outpour - Billed $29.99</li>
            </ul>
        </div>

        <div id="payment-methods">
            <h3 id="payment-title">Payment Methods</h3>
            <p>Next Payment due: 29.99 GBP</p>
            <p>Visa ending in 1234</p>
            <button class="update-payment-button">Update Payment Method</button>
        </div>
    </div>



    <div id="logout-section">
        <button class="logout-button">Logout</button>
    </div>
</div>
    


<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"/>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" src="/Clientside_JS/PoetrySub.js" type="module"></script>

<script src="//Clientside_JS/dateeditor-accountejs.js"></script>

<script> 
function toggleEdit() {
    const textSpan = document.getElementById('editable-text-address');
    const input = document.getElementById('edit-input');
    const saveBtn = document.getElementById('save-btn');

    input.value = textSpan.textContent;
    textSpan.style.display = 'none';
    input.style.display = 'inline';
    saveBtn.style.display = 'inline';
  };

  function saveEdit() {
    const textSpan = document.getElementById('editable-text-address');
    const input = document.getElementById('edit-input');
    const saveBtn = document.getElementById('save-btn');

    console.log('Saving new text:', input.value);

    textSpan.textContent = input.value;
    textSpan.style.display = 'inline';
    input.style.display = 'none';
    saveBtn.style.display = 'none';

    // Optional: Send updated text to server
    fetch('/account', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ newText: input.value })
    });
  }
  </script>


  <script>
    function toggleEditEmail() {
    const textSpan = document.getElementById('editable-text-email');
    const input = document.getElementById('edit-input-email');
    const saveBtnEmail = document.getElementById('save-btnemail');

    input.value = textSpan.textContent;
    textSpan.style.display = 'none';
    input.style.display = 'inline';
    saveBtnEmail.style.display = 'inline';
  };

  function saveEditEmail() {
    const textSpan = document.getElementById('editable-text-email');
    const input = document.getElementById('edit-input-email');
    const saveBtnEmail = document.getElementById('save-btnemail');

    console.log('Saving new text:', input.value);

    textSpan.textContent = input.value;
    textSpan.style.display = 'inline';
    input.style.display = 'none';
    saveBtnEmail.style.display = 'none';

    // Optional: Send updated text to server
    fetch('/account', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ newText: input.value })
    });
  }
  </script>

<%- include("partials/PS_footer.ejs") %>
</body>
</html>