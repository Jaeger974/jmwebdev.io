<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register New Account</title>
<link rel="stylesheet" href="/css/signupform.css"/> 
</head>
<body>

<%- include("partials/PS_header.ejs") %>

    <header class="signup-header">
  <h1>Join Our Poetry Subscription Service</h1>
</header>
<div class="mainbody">
<div class="signup-container">
  <h2>Create Account</h2>
  <form action="/newsignup" method="POST">

    <!-- First Name -->
    <div class="form-group">
      <input type="text" id="firstName" name="firstName" placeholder=" " required>
      <label for="firstName">First Name</label>
    </div>

    <!-- Last Name -->
    <div class="form-group">
      <input type="text" id="lastName" name="lastName" placeholder=" " required>
      <label for="lastName">Last Name</label>
    </div>

    <!-- Username -->
    <div class="form-group">
      <input type="text" id="username" name="username" placeholder=" " required>
      <label for="username">Username</label>
    </div>

    <!-- Email -->
    <div class="form-group">
      <input type="email" id="email" name="email" placeholder=" " required>
      <label for="email">Email Address</label>
      <% if (typeof message !== "undefined" && message) { %>

    <small class="error-message"><%= message %></small>
  <% } %>
    </div>

    <!-- Password -->
    <div class="form-group">
      <input type="password" id="password" name="password" placeholder=" " required>
      <label for="password">Password</label>
    </div>

    <!-- Confirm Password -->
    <div class="form-group">
      <input type="password" id="confirmPassword" name="confirmPassword" placeholder=" " required>
      <label for="confirmPassword">Confirm Password</label>
        <small id="passwordMessage"></small>

    </div>

    <!-- Address -->
    <h3>Your Address</h3>
    <div class="form-group">
      <input type="text" id="addressLine1" name="addressLine1" placeholder=" " required>
      <label for="addressLine1">Address Line 1</label>
    </div>

    <div class="form-group">
      <input type="text" id="addressLine2" name="addressLine2" placeholder=" ">
      <label for="addressLine2">Address Line 2</label>
    </div>

    <div class="form-group">
      <input type="text" id="city" name="city" placeholder=" " required>
      <label for="city">Town/City</label>
    </div>

    <div class="form-group">
      <input type="text" id="postcode" name="postcode" placeholder=" " required>
      <label for="postcode">Postcode / Zip Code</label>
    </div>

    <div class="form-group">
      <input type="text" id="country" name="country" placeholder=" " required>
      <label for="country">Country</label>
    </div>




        <!-- Radio Input -->
    <h4>Choose a Subscription level:</h4>
    <div class="radio-group">
      <label><input type="radio" name="choice" value="option1"  <%= choice === 'option1' ? 'checked' : '' %> checked required> School-ground Crush</label>
      <label><input type="radio" name="choice" value="option2"       <%= choice === 'option2' ? 'checked' : '' %>> New Love affair</label>
      <label><input type="radio" name="choice" value="option3" id="option3"       <%= choice === 'option3' ? 'checked' : '' %>> Passionate Outpour</label>
    </div>

    <!-- Frequency -->
    <h4>Select frequency of Delivery:</h4>
    <div class="radio-group2">
      <label><input type="radio" name="freqchoice" value="Option1" checked required> Every 2 weeks</label>
      <label><input type="radio" name="freqchoice" value="Option2"> Every Month</label>
      <label><input type="radio" name="freqchoice" value="Option3"> Every 2 Months</label>
      <label><input type="radio" name="freqchoice" value="Option4"> Every 6 Months</label>
    </div>

    <!-- Recipient Email -->

    
        <h3>Recipient Details</h3> 
        
        <div class="form-group">
      <input type="email" id="recipientEmail" name="recipientEmail" placeholder=" ">
      <label for="recipientEmail">Recipient Email</label>
    </div>


    <!-- Recipient Address (hidden by default) -->
    <div id="recipientAddressContainer" class="hidden">    
      
     

      <div class="form-group">
        <input type="text" id="recipientAddressLine1" name="recipientAddressLine1" placeholder=" " required>
        <label for="recipientAddressLine1">Recipient Address Line 1</label>
      </div>

      <div class="form-group">
        <input type="text" id="recipientAddressLine2" name="recipientAddressLine2" placeholder=" ">
        <label for="recipientAddressLine2">Recipient Address Line 2</label>
      </div>

      <div class="form-group">
        <input type="text" id="recipientCity" name="recipientCity" placeholder=" " required>
        <label for="recipientCity">Recipient Town/City</label>
      </div>

      <div class="form-group">
        <input type="text" id="recipientPostcode" name="recipientPostcode" placeholder=" " required>
        <label for="recipientPostcode">Recipient Postcode / Zip Code</label>
      </div>

      <div class="form-group">
        <input type="text" id="recipientCountry" name="recipientCountry" placeholder=" " required>
        <label for="recipientCountry">Recipient Country</label>
      </div>
    </div>

    

    <!-- Price Display -->
    <div id="priceDisplay" class="price-box">
      Total Romantic Investment: <span id="priceValue"></span>
    </div>

    <!-- Submit -->
    <button type="submit" id="submitBtn">Continue to payment</button>
    

   
  </form>
</div>
</div>

</body>



<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"/>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" src="/Clientside_JS/PoetrySub.js" type="module"></script>

 <script>
 document.addEventListener("DOMContentLoaded", () => {
      const option3Radio = document.getElementById("option3");
      const recipientContainer = document.getElementById("recipientAddressContainer");
      const radios = document.querySelectorAll("input[name='choice']");

      radios.forEach(radio => {
        radio.addEventListener("change", () => {
          if (option3Radio.checked) {
              recipientAddressLine1.required = true;
              recipientCity.required = true;
              recipientPostcode.required = true;
              recipientCountry.required = true;
                recipientContainer.classList.remove("hidden");
          } else {
              recipientAddressLine1.required = false;
              recipientCity.required = false;
              recipientPostcode.required = false;
              recipientCountry.required = false;
                recipientContainer.classList.add("hidden");
          }
        });
      });
});
  </script>

  <script>
  document.addEventListener("DOMContentLoaded", () => {
    const radios = document.querySelectorAll("input[name='choice']");
    const freqRadios = document.querySelectorAll("input[name='freqchoice']");
    const priceValue = document.getElementById("priceValue");

    const prices = {
      Option1: 3.99,
      Option2: 9.99,
      Option3: 24.99
    };

    const frequencyFactors = {
      Option1: 2.4,    // Every 2 weeks
      Option2: 1,      // Every month
      Option3: 0.7,   // Every 2 months
      Option4: 0.4  // Every 6 months
    };

    function updatePrice() {
      const selectedPlan = document.querySelector("input[name='choice']:checked").value;
      const selectedFreq = document.querySelector("input[name='freqchoice']:checked")?.value || "Option2"; 

      const basePrice = prices[selectedPlan];
      const multiplier = frequencyFactors[selectedFreq];
      const finalPrice = (basePrice * multiplier).toFixed(2);

      priceValue.textContent = "£" + finalPrice + " per Delivery";
    }

    radios.forEach(radio => radio.addEventListener("change", updatePrice));
    freqRadios.forEach(radio => radio.addEventListener("change", updatePrice));

    updatePrice();
  });
</script>

<script>


const password = document.getElementById("password");
const confirmPassword = document.getElementById("confirmPassword");
const submitBtn = document.getElementById("submitBtn");
const message = document.getElementById("passwordMessage");

function validatePasswords() {
  if (password.value && confirmPassword.value) {
    if (password.value !== confirmPassword.value) {
      // ❌ mismatch
      confirmPassword.setCustomValidity("Passwords do not match");
      message.textContent = "Passwords do not match ❌";
      message.style.color = "red";
      submitBtn.disabled = true;
    } else {
      // ✅ match
      confirmPassword.setCustomValidity("");
      message.textContent = "Passwords match ✅";
      message.style.color = "green";
      submitBtn.disabled = false;
    }
  } else {
    // empty fields
    confirmPassword.setCustomValidity("Please confirm your password");
    message.textContent = "";
    submitBtn.disabled = true;
  }
}

// Run validation whenever user types
password.addEventListener("input", validatePasswords);
confirmPassword.addEventListener("input", validatePasswords);

</script>

<%- include("partials/PS_footer.ejs") %>

</body>
</html>

